<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>hexo+nginx服务器上部署博客(一) | Cquang博客</title><meta name="keywords" content="hexo,nginx,服务器,git"><meta name="author" content="Cai XianQuan"><meta name="copyright" content="Cai XianQuan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="参考网上文章，结合自己服务器情况，搭建一个hexo博客方便自己总结笔记。">
<meta property="og:type" content="article">
<meta property="og:title" content="hexo+nginx服务器上部署博客(一)">
<meta property="og:url" content="https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/index.html">
<meta property="og:site_name" content="Cquang博客">
<meta property="og:description" content="参考网上文章，结合自己服务器情况，搭建一个hexo博客方便自己总结笔记。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80%E9%A6%96%E9%A1%B5.png">
<meta property="article:published_time" content="2020-06-29T08:33:10.000Z">
<meta property="article:modified_time" content="2021-09-23T06:58:33.029Z">
<meta property="article:author" content="Cai XianQuan">
<meta property="article:tag" content="git">
<meta property="article:tag" content="hexo">
<meta property="article:tag" content="nginx">
<meta property="article:tag" content="服务器">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80%E9%A6%96%E9%A1%B5.png"><link rel="shortcut icon" href="/myblog/img/favicon1.png"><link rel="canonical" href="https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/myblog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/myblog/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2021-09-23 14:58:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><link rel="stylesheet" href="/myblog/css/VolantisTags.css"><meta name="generator" content="Hexo 5.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/myblog/img/%E5%A4%B4%E5%83%8F.gif" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/myblog/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/myblog/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/myblog/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/myblog/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 享受时光</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/myblog/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/myblog/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80%E9%A6%96%E9%A1%B5.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/myblog/">Cquang博客</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/myblog/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/myblog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 享受时光</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/myblog/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">hexo+nginx服务器上部署博客(一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-06-29T08:33:10.000Z" title="发表于 2020-06-29 16:33:10">2020-06-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-23T06:58:33.029Z" title="更新于 2021-09-23 14:58:33">2021-09-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/myblog/categories/hexo%E5%8D%9A%E5%AE%A2/">hexo博客</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="操作环境"><a href="#操作环境" class="headerlink" title="操作环境"></a>操作环境</h1><div class="note info flat"><ul>
<li>VPS服务器，CentOS7【搬瓦工官网服务器】</li>
<li>Windows PC（本地环境使用win 10）</li>
</ul>
</div>

<h1 id="本章重点"><a href="#本章重点" class="headerlink" title="本章重点"></a>本章重点</h1><ul>
<li>服务器CentOS上安装git</li>
<li>服务器CentOS上安装和配置nginx</li>
<li>本地Windows安装node.js与git</li>
</ul>
<h1 id="服务器上安装Git"><a href="#服务器上安装Git" class="headerlink" title="服务器上安装Git"></a>服务器上安装Git</h1><h2 id="服务器上创建用户"><a href="#服务器上创建用户" class="headerlink" title="服务器上创建用户"></a>服务器上创建用户</h2><div class="note danger flat"><p>这里创建一个普通用户来对接本地的git，进行之后的push等操作，避免使用root，以防风险。同时也为了使后面使用ssh免密登录而做准备。</p>
</div>

<h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><figure class="highlight bash"><figcaption><span>创建用户</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@107  ~]<span class="comment"># useradd caixianquan</span></span><br><span class="line">[root@107  ~]<span class="comment"># passwd caixianquan</span></span><br><span class="line">Changing  password  <span class="keyword">for</span> user caixianquan.</span><br><span class="line">New  password:</span><br><span class="line">Retype  new  password:</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure>
<h3 id="授予权限"><a href="#授予权限" class="headerlink" title="授予权限"></a>授予权限</h3><figure class="highlight bash"><figcaption><span>授予用户权限</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看sudoers文件权限，只有read权限</span></span><br><span class="line">[root@107  ~]<span class="comment"># ll /etc/sudoers</span></span><br><span class="line">-r--r-----  1  root  root  4328  Nov  28  2019  /etc/sudoers</span><br><span class="line"><span class="comment">#修改文件权限为700，可以在root下修改文件内容</span></span><br><span class="line">[root@107  ~]<span class="comment"># chmod 700 /etc/sudoers</span></span><br><span class="line">[root@107  ~]<span class="comment"># ll /etc/sudoers</span></span><br><span class="line">-rwx------  1  root  root  4328  Nov  28  2019  /etc/sudoers</span><br><span class="line">[root@107  ~]<span class="comment"># vim /etc/sudoers</span></span><br></pre></td></tr></table></figure>
<p>找到以下内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##  Allow  root  to  run  any  commands  anywhere</span></span><br><span class="line">root  ALL=(ALL)  ALL</span><br></pre></td></tr></table></figure>
<p>在其下面添加一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">caixianquan  ALL=(ALL)  ALL</span><br></pre></td></tr></table></figure>
<p>保存退出，将权限修改回来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@107  ~]<span class="comment"># chmod 400 /etc/sudoers</span></span><br><span class="line">[root@107  ~]<span class="comment"># ll /etc/sudoers</span></span><br><span class="line">-r--------  1  root  root  4360  Jun  5  10:15  /etc/sudoers</span><br></pre></td></tr></table></figure>
<h2 id="服务器上安装Git-1"><a href="#服务器上安装Git-1" class="headerlink" title="服务器上安装Git"></a>服务器上安装Git</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@107 ~]<span class="comment"># yum install git</span></span><br><span class="line">[root@107 ~]<span class="comment"># git config --global user.name &quot;caixianquan&quot;</span></span><br><span class="line">[root@107 ~]<span class="comment"># git config --global user.email &quot;854191181@qq.com&quot;</span></span><br></pre></td></tr></table></figure>
<div class="note info flat"><p>网上解释：因为Git是分布式版本控制系统，所以，每个机器都必须自报家门：你的名字和Email地址。你也许会担心，如果有人故意冒充别人怎么办？这个不必担心，首先我们相信大家都是善良无知的群众，其次，真的有冒充的也是有办法可查的。</p>
<p>注意git config命令的–global参数，用了这个参数，表示你这台机器上所有的Git仓库都会使用这个配置，当然也可以对某个仓库指定不同的用户名和Email地址。</p>
</div>

<h1 id="服务器上安装和配置Nginx"><a href="#服务器上安装和配置Nginx" class="headerlink" title="服务器上安装和配置Nginx"></a>服务器上安装和配置Nginx</h1><h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@107 ~]<span class="comment"># yum install nginx # 安装nginx</span></span><br><span class="line">[root@107 ~]<span class="comment"># systemctl start nginx # 启动nginx</span></span><br><span class="line">[root@107 ~]<span class="comment"># systemctl enable nginx.service # 设置为开机启动</span></span><br><span class="line">[root@107 ~]<span class="comment"># systemctl status nginx # 查看nginx服务状态</span></span><br></pre></td></tr></table></figure>
<div class="note primary flat"><ol>
<li>报错一：<br>yum安装nginx报错信息如下：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 etc]# yum install -y nginx</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.dgut.edu.cn</span><br><span class="line"> * extras: mirrors.dgut.edu.cn</span><br><span class="line"> * updates: mirrors.dgut.edu.cn</span><br><span class="line">No package nginx available.</span><br><span class="line">Error: Nothing to do</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>解决办法：安装一个源</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release -y</span><br><span class="line">yum install nginx -y</span><br></pre></td></tr></table></figure>
<p>解释：<br>EPEL (Extra Packages for Enterprise Linux)是基于Fedora的一个项目，为“红帽系”的操作系统提供额外的软件包，适用于RHEL、CentOS和Scientific Linux.</p>
<p>我们在Centos下使用yum安装时往往找不到rpm的情况，官方的rpm repository提供的rpm包也不够丰富，很多时候需要自己编译很痛苦，而EPEL恰恰可以解决这两方面的问题。EPEL的全称叫 Extra Packages for Enterprise Linux 。EPEL是由 Fedora 社区打造，为 RHEL 及衍生发行版如 CentOS、Scientific Linux 等提供高质量软件包的项目。装上了 EPEL之后，就相当于添加了一个第三方源。</p>
<ol start="2">
<li>报错2：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 yum.repos.d]# systemctl start nginx</span><br><span class="line">Failed to start nginx.service: Access denied</span><br><span class="line">See system logs and &#x27;systemctl status nginx.service&#x27; for details.</span><br></pre></td></tr></table></figure>
需要执行命令：<code>systemctl daemon-reexec</code>，再启动服务</li>
</ol>
<p>解释：</p>
<p>daemon-reexec Reexecute the systemd manager. This will serialize the manager state, reexecute the process and deserialize the state again. This command is of little use except for debugging and package upgrades. Sometimes, it might be helpful as a heavy-weight daemon-reload.</p>
</div>
<p>此时用浏览器访问服务器公网ip就可以看到<br><img src="1%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9F%A5%E7%9C%8Bnginx%E6%98%AF%E5%90%A6%E5%90%AF%E5%8A%A8%E6%88%90%E5%8A%9F.png" alt="浏览器查看nginx是否启动成功"></p>
<div class="note info flat"><p>无法访问页面是防火墙没有开启80端口<br>开启命令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@centos7 ~]# firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line"></span><br><span class="line">查询端口号80 是否开启：[root@centos7 ~]# firewall-cmd --query-port=80/tcp</span><br><span class="line"></span><br><span class="line">重启防火墙：[root@centos7 ~]# firewall-cmd --reload</span><br><span class="line"></span><br><span class="line">查询有哪些端口是开启的:[root@centos7 ~]# firewall-cmd --list-port</span><br><span class="line"></span><br><span class="line">命令含义：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--zone #作用域</span><br><span class="line">--add-port=80/tcp #添加端口，格式为：端口/通讯协议</span><br><span class="line">--permanent #永久生效，没有此参数重启后失效</span><br><span class="line"></span><br><span class="line">关闭firewall：</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld.service #停止firewall</span><br><span class="line"></span><br><span class="line">systemctl disable firewalld.service #禁止firewall开机启动</span><br></pre></td></tr></table></figure></div>

<h2 id="配置SSL证书"><a href="#配置SSL证书" class="headerlink" title="配置SSL证书"></a>配置SSL证书</h2><p>如果使用yum安装的nginx，一般都会默认安装有SSL模块，手动安装的就可以参考下面文章。<br>该小节参考地址：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_37264997/article/details/84525444?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-4.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-4.nonecase">Nginx 配置 HTTPS 完整过程</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/GX_1_11_real/article/details/85784689">使用yum安装下的nginx，添加模块的方法</a></p>
<h3 id="nginx的ssl模块安装"><a href="#nginx的ssl模块安装" class="headerlink" title="nginx的ssl模块安装"></a>nginx的ssl模块安装</h3><div class="note info flat"><ul>
<li>查看 nginx 是否安装 <code>http_ssl_module</code> 模块。<br>注意：这里的V是大写，小写不会显示安装的模块信息</li>
</ul>
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/<span class="built_in">local</span>/nginx/sbin/nginx -V</span><br></pre></td></tr></table></figure>
<p><img src="3%E3%80%81%E6%9F%A5%E7%9C%8Bnginx%E5%AE%89%E8%A3%85%E6%A8%A1%E5%9D%97%E4%BF%A1%E6%81%AF.png" alt="查看nginx安装模块信息"><br>如果出现 <code>configure arguments: --with-http_ssl_module</code>, 则已安装。</p>
<h3 id="SSL证书获取"><a href="#SSL证书获取" class="headerlink" title="SSL证书获取"></a>SSL证书获取</h3><p>在阿里云申请免费证书，如果域名不在阿里云，还需要<br>进行域名解析。百度查找申请SSL证书。</p>
<h3 id="SSL证书部署"><a href="#SSL证书部署" class="headerlink" title="SSL证书部署"></a>SSL证书部署</h3><p>从阿里云上下载ssl证书文件压缩包（包含pem和key文件）。可以放到nginx配置目录下。配置文件nginx.conf在后面列出。</p>
<h2 id="nginx配置文件"><a href="#nginx配置文件" class="headerlink" title="nginx配置文件"></a>nginx配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">user nginx;</span><br><span class="line">worker_processes auto;</span><br><span class="line">error_log /var/<span class="built_in">log</span>/nginx/error.log;</span><br><span class="line">pid /run/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.</span></span><br><span class="line">include /usr/share/nginx/modules/*.conf;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections 1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    log_format  main  <span class="string">&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    access_log  /var/<span class="built_in">log</span>/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile            on;</span><br><span class="line">    tcp_nopush          on;</span><br><span class="line">    tcp_nodelay         on;</span><br><span class="line">    keepalive_timeout   65;</span><br><span class="line">    types_hash_max_size 2048;</span><br><span class="line">    gzip                on;</span><br><span class="line"></span><br><span class="line">    include             /etc/nginx/mime.types;</span><br><span class="line">    default_type        application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load modular configuration files from the /etc/nginx/conf.d directory.</span></span><br><span class="line">    <span class="comment"># See http://nginx.org/en/docs/ngx_core_module.html#include</span></span><br><span class="line">    <span class="comment"># for more information.</span></span><br><span class="line">    <span class="comment"># include /etc/nginx/conf.d/*.conf;</span></span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  www.caixianquan.tk;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /opt/blog;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># HTTPS server</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       443 ssl;</span><br><span class="line">        server_name  www.caixianquan.tk;</span><br><span class="line"></span><br><span class="line">        ssl_certificate      /etc/nginx/4043710_www.caixianquan.tk.pem;</span><br><span class="line">        ssl_certificate_key  /etc/nginx/4043710_www.caixianquan.tk.key;</span><br><span class="line"></span><br><span class="line">        ssl_session_cache    shared:SSL:1m;</span><br><span class="line">        ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">        ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /opt/blog;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note primary flat"><p>可以去掉http的server配置信息，保留也不会出什么问题【如果没有配置SSL证书，就需要配置http信息】；<br>配置ssl_certificate和ssl_certificate_key属性，使用绝地路径，也可以使用相对路径；<br>使用yum安装的nginx服务，在配置服务器名称后会在conf.d文件夹下生成一个以域名为名的conf文件，里面是http重定向。如下所示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name www.caixianquan.tk;</span><br><span class="line">    rewrite ^(.*) https://<span class="variable">$server_name</span>:4431<span class="variable">$1</span> permanent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>如果启动时出现如下错误：<br><img src="2%E3%80%81%E5%87%BA%E7%8E%B0%E7%9A%84%E9%94%99%E8%AF%AF.png" alt="出现的错误">    </p>
<div class="note warning flat"><p>暂未解决，重新安装的Nginx服务。</p>
<p>指定证书后由于无法加载证书而无法启动，报错如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 nginx]# systemctl status nginx.service -l</span><br><span class="line">● nginx.service - The nginx HTTP and reverse proxy server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: failed (Result: exit-code) since Tue 2021-09-21 23:45:55 EDT; 18s ago</span><br><span class="line">  Process: 4551 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 7755 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=1/FAILURE)</span><br><span class="line">  Process: 7752 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 4554 (code=exited, status=0/SUCCESS)</span><br><span class="line"></span><br><span class="line">Sep 21 23:45:55 server_centos8 systemd[1]: Starting The nginx HTTP and reverse proxy server...</span><br><span class="line">Sep 21 23:45:55 server_centos8 nginx[7755]: nginx: [emerg] cannot load certificate &quot;/home/caixianquan/1_www.caixianquan.tk_bundle.crt&quot;: BIO_new_file() failed (SSL: error:0200100D:system library:fopen:Permission denied:fopen(&#x27;/home/caixianquan/1_www.caixianquan.tk_bundle.crt&#x27;,&#x27;r&#x27;) error:2006D002:BIO routines:BIO_new_file:system lib)</span><br><span class="line">Sep 21 23:45:55 server_centos8 nginx[7755]: nginx: configuration file /etc/nginx/nginx.conf test failed</span><br><span class="line">Sep 21 23:45:55 server_centos8 systemd[1]: nginx.service: control process exited, code=exited status=1</span><br><span class="line">Sep 21 23:45:55 server_centos8 systemd[1]: Failed to start The nginx HTTP and reverse proxy server.</span><br><span class="line">Sep 21 23:45:55 server_centos8 systemd[1]: Unit nginx.service entered failed state.</span><br><span class="line">Sep 21 23:45:55 server_centos8 systemd[1]: nginx.service failed.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol>
<li><p>解决方案一：<br>这里可以直接先临时关闭setLinux安全子系统，再启动nginx服务，最后再开启setLinux安全子系统<br><code>setenforce 0</code><br><code>restart nginx.service</code><br><code>setenforce 1</code></p>
</li>
<li><p>解决方案二：<br>方案一如果系统重启，还是得手动才能启动nginx服务，有点麻烦，尝试从setLinux层面入手解决。<br>安装semanage： </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看semanage在哪个包</span></span><br><span class="line">[root@server_centos8 ssl]# yum provides semanage</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.nju.edu.cn</span><br><span class="line"> * epel: ftp.riken.jp</span><br><span class="line"> * extras: mirrors.nju.edu.cn</span><br><span class="line"> * updates: mirrors.nju.edu.cn</span><br><span class="line">base/7/x86_64/filelists_db                                                                                                        | 7.2 MB  00:00:03     </span><br><span class="line">epel/x86_64/filelists_db                                                                                                          |  12 MB  00:00:58     </span><br><span class="line">extras/7/x86_64/filelists_db                                                                                                      | 259 kB  00:00:00     </span><br><span class="line">updates/7/x86_64/filelists_db                                                                                                     | 6.1 MB  00:00:00     </span><br><span class="line">policycoreutils-python-2.5-34.el7.x86_64 : SELinux policy core python utilities</span><br><span class="line">Repo        : base</span><br><span class="line">Matched from:</span><br><span class="line">Filename    : /usr/sbin/semanage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">policycoreutils-python-2.5-34.el7.x86_64 : SELinux policy core python utilities</span><br><span class="line">Repo        : @base</span><br><span class="line">Matched from:</span><br><span class="line">Filename    : /usr/sbin/semanage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@server_centos8 ssl]#  yum install policycoreutils-python-2.5-34.el7.x86_64</span><br></pre></td></tr></table></figure>
<p>查看setLinux文件权限，如下是<code>admin_home_t</code>,将其修改为<code>httpd_config_t</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 ~]# ls</span><br><span class="line">1_www.caixianquan.tk_bundle.crt  2_www.caixianquan.tk.key  anaconda-ks.cfg  www.caixianquan.tk.key  www.caixianquan.tk.pem</span><br><span class="line">[root@server_centos8 ~]# ls -lrtZ ./</span><br><span class="line">-rw-------. root root system_u:object_r:admin_home_t:s0 anaconda-ks.cfg</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 www.caixianquan.tk.pem</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 www.caixianquan.tk.key</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 2_www.caixianquan.tk.key</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 1_www.caixianquan.tk_bundle.crt</span><br><span class="line"></span><br><span class="line">[root@server_centos8 ~]# chcon -t httpd_config_t www.caixianquan.tk.key</span><br><span class="line">[root@server_centos8 ~]# chcon -t httpd_config_t www.caixianquan.tk.pem</span><br><span class="line">[root@server_centos8 ~]# ls -lrtZ ./</span><br><span class="line">-rw-------. root root system_u:object_r:admin_home_t:s0 anaconda-ks.cfg</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:httpd_config_t:s0 www.caixianquan.tk.pem</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:httpd_config_t:s0 www.caixianquan.tk.key</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 2_www.caixianquan.tk.key</span><br><span class="line">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 1_www.caixianquan.tk_bundle.crt</span><br></pre></td></tr></table></figure>
<p>再重新启动nginx服务，报新错：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 ~]# systemctl start nginx.service</span><br><span class="line">Job for nginx.service failed because the control process exited with error code. See &quot;systemctl status nginx.service&quot; and &quot;journalctl -xe&quot; for details.</span><br><span class="line">[root@server_centos8 ~]# systemctl status nginx.service -l</span><br><span class="line">● nginx.service - The nginx HTTP and reverse proxy server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: failed (Result: exit-code) since Thu 2021-09-23 02:10:12 EDT; 11s ago</span><br><span class="line">  Process: 1890 ExecStart=/usr/sbin/nginx (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 2482 ExecStartPre=/usr/sbin/nginx -t (code=exited, status=1/FAILURE)</span><br><span class="line">  Process: 2480 ExecStartPre=/usr/bin/rm -f /run/nginx.pid (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 1892 (code=exited, status=0/SUCCESS)</span><br><span class="line"></span><br><span class="line">Sep 23 02:10:12 server_centos8 systemd[1]: Starting The nginx HTTP and reverse proxy server...</span><br><span class="line">Sep 23 02:10:12 server_centos8 nginx[2482]: nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">Sep 23 02:10:12 server_centos8 nginx[2482]: nginx: [emerg] bind() to 0.0.0.0:88 failed (13: Permission denied)</span><br><span class="line">Sep 23 02:10:12 server_centos8 nginx[2482]: nginx: configuration file /etc/nginx/nginx.conf test failed</span><br><span class="line">Sep 23 02:10:12 server_centos8 systemd[1]: nginx.service: control process exited, code=exited status=1</span><br><span class="line">Sep 23 02:10:12 server_centos8 systemd[1]: Failed to start The nginx HTTP and reverse proxy server.</span><br><span class="line">Sep 23 02:10:12 server_centos8 systemd[1]: Unit nginx.service entered failed state.</span><br><span class="line">Sep 23 02:10:12 server_centos8 systemd[1]: nginx.service failed.</span><br></pre></td></tr></table></figure>
<p>这是由于修改了端口80为88，仅在firewall-cmd开放了端口，而在setLinux中并没有开放相关策略的端口（setLinux为enforce模式）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 ssl]# semanage port -l | grep http_port_t</span><br><span class="line">http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000</span><br><span class="line">pegasus_http_port_t            tcp      5988</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">添加端口88</span></span><br><span class="line">[root@server_centos8 ssl]# semanage port -a -t http_port_t  -p tcp 88</span><br><span class="line">ValueError: Port tcp/88 already defined  #该端口存在其他协议报错</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">将-a改为-m，即不会影响其他策略使用88端口</span></span><br><span class="line">[root@server_centos8 ssl]# semanage port -m -t http_port_t  -p tcp 88</span><br></pre></td></tr></table></figure>
<p>同理https的端口由于修改为4431，也需要进行添加端口，但用<code>-m</code>参数会报端口不存在，所以需要改为用<code>-a</code>参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@server_centos8 ssl]# semanage port -m -t http_port_t  -p tcp 4431</span><br><span class="line">ValueError: Port @tcp/4431 is not defined</span><br><span class="line">[root@server_centos8 ssl]# semanage port -a -t http_port_t  -p tcp 4431</span><br></pre></td></tr></table></figure>
<p>重启nginx服务即可完美解决问题</p>
</li>
</ol>
</div>    

<h1 id="本地Windows安装node-js与git"><a href="#本地Windows安装node-js与git" class="headerlink" title="本地Windows安装node.js与git"></a>本地Windows安装node.js与git</h1><p>主要是通过软件直接安装，具体直接百度即可。然后在系统环境变量中将node.js和git的安装目录填写到path变量中【如果安装时没有自动添加环境的话】</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Cai XianQuan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/">https://cxquang.github.io/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://cxquang.github.io" target="_blank">Cquang博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/myblog/tags/git/">git</a><a class="post-meta__tags" href="/myblog/tags/hexo/">hexo</a><a class="post-meta__tags" href="/myblog/tags/nginx/">nginx</a><a class="post-meta__tags" href="/myblog/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></div><div class="post_share"><div class="social-share" data-image="/myblog/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80%E9%A6%96%E9%A1%B5.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/myblog/2020/07/03/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%BA%8C/"><img class="prev-cover" src="/myblog/2020/07/03/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%BA%8C/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%BA%8C%E9%A6%96%E9%A1%B5.jpg" onerror="onerror=null;src='/myblog/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">hexo+nginx服务器上部署博客(二)</div></div></a></div><div class="next-post pull-right"><a href="/myblog/2020/06/29/Proxifier%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"><img class="next-cover" src="/myblog/2020/06/29/Proxifier%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/Proxifier%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%E9%A6%96%E9%A1%B5.png" onerror="onerror=null;src='/myblog/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Proxifier使用教程</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/myblog/2020/07/03/hexo-nginx服务器上部署博客-二/" title="hexo+nginx服务器上部署博客(二)"><img class="cover" src="/myblog/2020/07/03/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%BA%8C/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%BA%8C%E9%A6%96%E9%A1%B5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-03</div><div class="title">hexo+nginx服务器上部署博客(二)</div></div></a></div><div><a href="/myblog/2020/08/16/Git知识点及问题收集/" title="Git知识点及问题收集"><img class="cover" src="/myblog/2020/08/16/Git%E7%9F%A5%E8%AF%86%E7%82%B9%E5%8F%8A%E9%97%AE%E9%A2%98%E6%94%B6%E9%9B%86/Git%E7%9F%A5%E8%AF%86%E7%82%B9%E5%8F%8A%E9%97%AE%E9%A2%98%E6%94%B6%E9%9B%86%E9%A6%96%E9%A1%B5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-16</div><div class="title">Git知识点及问题收集</div></div></a></div></div></div></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/myblog/img/%E5%A4%B4%E5%83%8F.gif" onerror="this.onerror=null;this.src='/myblog/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Cai XianQuan</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/myblog/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/myblog/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/myblog/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div></div><a class="button--animated" id="card-info-btn" href="javascript:;"><i class="fab fa-bookmark"></i><span>加入书签</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">一花一世界,一木一菩提╮(￣▽ ￣)╭</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">操作环境</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AC%E7%AB%A0%E9%87%8D%E7%82%B9"><span class="toc-number">2.</span> <span class="toc-text">本章重点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%AE%89%E8%A3%85Git"><span class="toc-number">3.</span> <span class="toc-text">服务器上安装Git</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">3.1.</span> <span class="toc-text">服务器上创建用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">3.1.1.</span> <span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%88%E4%BA%88%E6%9D%83%E9%99%90"><span class="toc-number">3.1.2.</span> <span class="toc-text">授予权限</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%AE%89%E8%A3%85Git-1"><span class="toc-number">3.2.</span> <span class="toc-text">服务器上安装Git</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AENginx"><span class="toc-number">4.</span> <span class="toc-text">服务器上安装和配置Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Nginx"><span class="toc-number">4.1.</span> <span class="toc-text">安装Nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6"><span class="toc-number">4.2.</span> <span class="toc-text">配置SSL证书</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nginx%E7%9A%84ssl%E6%A8%A1%E5%9D%97%E5%AE%89%E8%A3%85"><span class="toc-number">4.2.1.</span> <span class="toc-text">nginx的ssl模块安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL%E8%AF%81%E4%B9%A6%E8%8E%B7%E5%8F%96"><span class="toc-number">4.2.2.</span> <span class="toc-text">SSL证书获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSL%E8%AF%81%E4%B9%A6%E9%83%A8%E7%BD%B2"><span class="toc-number">4.2.3.</span> <span class="toc-text">SSL证书部署</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text">nginx配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">4.4.</span> <span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0Windows%E5%AE%89%E8%A3%85node-js%E4%B8%8Egit"><span class="toc-number">5.</span> <span class="toc-text">本地Windows安装node.js与git</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/myblog/2021/08/31/Scala%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/" title="Scala语法学习"><img src="/myblog/2021/08/31/Scala%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/Scala%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0%E9%A6%96%E9%A1%B5.jpg" onerror="this.onerror=null;this.src='/myblog/img/404.jpg'" alt="Scala语法学习"/></a><div class="content"><a class="title" href="/myblog/2021/08/31/Scala%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/" title="Scala语法学习">Scala语法学习</a><time datetime="2021-08-31T02:10:50.000Z" title="发表于 2021-08-31 10:10:50">2021-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/myblog/2021/06/02/%E6%94%B6%E9%9B%86%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8A%80%E5%B7%A7/" title="收集正则表达式技巧"><img src="/myblog/2021/06/02/%E6%94%B6%E9%9B%86%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8A%80%E5%B7%A7/%E6%94%B6%E9%9B%86%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8A%80%E5%B7%A7%E9%A6%96%E9%A1%B5.jpg" onerror="this.onerror=null;this.src='/myblog/img/404.jpg'" alt="收集正则表达式技巧"/></a><div class="content"><a class="title" href="/myblog/2021/06/02/%E6%94%B6%E9%9B%86%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8A%80%E5%B7%A7/" title="收集正则表达式技巧">收集正则表达式技巧</a><time datetime="2021-06-02T07:25:22.000Z" title="发表于 2021-06-02 15:25:22">2021-06-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/myblog/2021/04/26/hello-world/" title="Hello World"><img src="/myblog/img/default_cover.jpg" onerror="this.onerror=null;this.src='/myblog/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/myblog/2021/04/26/hello-world/" title="Hello World">Hello World</a><time datetime="2021-04-26T13:25:30.164Z" title="发表于 2021-04-26 21:25:30">2021-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/myblog/2021/04/20/Java%E5%9F%BA%E7%A1%80/" title="Java基础"><img src="/myblog/2021/04/20/Java%E5%9F%BA%E7%A1%80/Java%E5%9F%BA%E7%A1%80%E9%A6%96%E9%A1%B5.jpg" onerror="this.onerror=null;this.src='/myblog/img/404.jpg'" alt="Java基础"/></a><div class="content"><a class="title" href="/myblog/2021/04/20/Java%E5%9F%BA%E7%A1%80/" title="Java基础">Java基础</a><time datetime="2021-04-20T15:02:55.000Z" title="发表于 2021-04-20 23:02:55">2021-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/myblog/2021/04/20/Java%E9%AB%98%E7%BA%A7%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/" title="Java高级机制学习"><img src="/myblog/2021/04/20/Java%E9%AB%98%E7%BA%A7%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/Java%E9%AB%98%E7%BA%A7%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0%E9%A6%96%E9%A1%B5.jpg" onerror="this.onerror=null;this.src='/myblog/img/404.jpg'" alt="Java高级机制学习"/></a><div class="content"><a class="title" href="/myblog/2021/04/20/Java%E9%AB%98%E7%BA%A7%E6%9C%BA%E5%88%B6%E5%AD%A6%E4%B9%A0/" title="Java高级机制学习">Java高级机制学习</a><time datetime="2021-04-19T19:04:07.000Z" title="发表于 2021-04-20 03:04:07">2021-04-20</time></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/myblog/2020/06/29/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80/hexo-nginx%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2-%E4%B8%80%E9%A6%96%E9%A1%B5.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Cai XianQuan</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi,  welcome  to  my  <a  target="_blank" rel="noopener" href="https://www.caixianquan.tk">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/myblog/js/utils.js"></script><script src="/myblog/js/main.js"></script><script src="/myblog/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/myblog/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/myblog/js/bookmark.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script></div></body></html>